<div class="flex flex-row h-full w-full gap-x-4">
    <ol class="flex flex-col h-full gap-y-2">
        <li class="flex items-center gap-x-2.5">
            <a class="w-8.5 h-8.5 rounded-lg flex items-center justify-center cursor-pointer bg-white border border-grey-dc"
                matRipple [routerLink]="['/home']">
                <svg width="22" height="20" viewBox="0 0 22 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.21101 19V8.76471H2L11.3578 1L20 8.61345H19.0642V18.9496H14.2752V12.1429H8.15596V19" stroke="#333333"
                        stroke-miterlimit="10" />
                </svg>

            </a>
            <a class="w-8.5 h-8.5 rounded-lg flex items-center justify-center cursor-pointer bg-white border border-grey-dc"
                matRipple [routerLink]="['/home/export_invoice']">
                <svg width="18" height="18" viewBox="0 0 18 18" class="stroke-menu-outline" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_118_782)">
                        <path
                            d="M1.32642 5.21053H10.6106C13.9264 5.21053 16.6738 7.95789 16.6738 11.2737C16.6738 14.5895 13.9264 17.3368 10.6106 17.3368H1.32642"
                            stroke="#333333" stroke-miterlimit="10" />
                        <path d="M5.4001 9.37895L1.32642 5.21053L5.4001 1.13684" stroke-miterlimit="10" />
                    </g>
                    <defs>
                        <clipPath id="clip0_118_782">
                            <rect width="18" height="18" fill="white" />
                        </clipPath>
                    </defs>
                </svg>
            </a>
        </li>
    </ol>
    <div class="flex-1 flex flex-col h-full w-full gap-y-2">
        <div class="flex-1 relative">
            <div class="absolute top-0 left-0 right-0 bottom-0 z-0 overflow-hidden">
                <div class="relative w-full h-full z-10 overflow-auto">
                    <div class="flex flex-col h-full bg-white rounded">
                        <div class="flex-1 relative">
                            <div class="absolute top-0 left-0 right-0 bottom-0 z-0 overflow-hidden">
                                <div class="relative w-full h-full z-10 overflow-auto">
                                    <form class="flex flex-col gap-y-2 h-full max-w-4xl mx-auto py-4" #l="ngForm" (ngSubmit)="save()">
                                        <div class="grid grid-cols-3 gap-x-3 p-4 bg-[#F9F9F9]">
                                            <div class="block">
                                                <app-input-control label="Invoice No" [(ngModel)]="exportInvoice.invoiceNo" name="invoiceNo"
                                                    ></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-date-control label="Invoice Date"
                                                    [(ngModel)]="exportInvoice.invoiceDate" name="invoiceDate"></app-date-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Vessel / Flight No" [(ngModel)]="exportInvoice.vesselFlightNo" name="vesselFlightNo"></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Port of Loading" [(ngModel)]="exportInvoice.loadingPortDescription" name="loadingPortDescription"></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Port of Discharge" [(ngModel)]="exportInvoice.dischargePortDescription" name="dischargePortDescription"></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Final Destination" [(ngModel)]="exportInvoice.destination" name="destination"></app-input-control>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-3 gap-x-3 py-2 mx-4 border-b border-b-grey-dc">
                                            <div class="block">
                                                <app-input-control label="Pre-Carriage By"
                                                    [(ngModel)]="exportInvoice.preCarriageBy" name="preCarriageBy"></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Place of Receipt of Pre Carrier"
                                                   [(ngModel)]="exportInvoice.placeOfReceiptOfPreCarrier" name="placeOfReceiptOfPreCarrier" ></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Container No"
                                                     [(ngModel)]="exportInvoice.containerNo" name="containerNo"></app-input-control>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-3 gap-x-3 py-2 mx-4 border-b border-b-grey-dc">
                                            <div class="block">
                                                <app-input-control label="Country of Origin of Goods"
                                                    [(ngModel)]="exportInvoice.countryOfOriginOfGoods" name="countryOfOriginOfGoods"></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Country of Final Destination"
                                                   [(ngModel)]="exportInvoice.countryOfFinalDestination" name="countryOfFinalDestination"></app-input-control>
                                            </div>
                                            <div class="block">
                                                <app-input-control label="Buyerâ€™s Order No."
                                                   [(ngModel)]="exportInvoice.buyersOrderNoDate" name="buyersOrderNoDate"></app-input-control>
                                            </div>
                                            <div class="block col-span-3">
                                               <app-text-area label="Term of delivery payment" [(ngModel)]="exportInvoice.termsOfDeliveryPayment" name="termsOfDeliveryPayment"></app-text-area>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-3 gap-x-3 mx-4 py-2">
                                            <div class="block">
                                                <app-exporter label="Exporter Name"  [(ngModel)]="exportInvoice.exporterId" name="exporterId" [displayText]="exportInvoice.iprotoExporter.exporterName" (onSelect)="selectExporter($event)"></app-exporter>
                                            </div>
                                            <div class="block">
                                                <app-exporter-consignee label="Consignee (Ship to)" [(ngModel)]="exportInvoice.exportConsigneeId" name="exportConsigneeId" (onSelect)="consigneeSelect($event)" [displayText]="exportInvoice.iprotoExportConsignee.exportConsigneeName"></app-exporter-consignee>
                                               
                                            </div>
                                            <div class="block">
                                                <app-search-party label="Notify Party"  [(ngModel)]="exportInvoice.partyId" name="partyId" [displayText]="exportInvoice.iprotoParty.partyName"(onSelect)="selectParty($event)"></app-search-party>
                                               
                                            </div>
                                        </div>
                                        <div class="block border-b border-b-grey-dc pb-4 mx-4">
                                            <div class="grid grid-cols-3 bg-[#F9F9F9] gap-x-4 p-4">
                                                <div class="flex flex-col">
                                                    <p class="text-xs whitespace-pre-line break-all">
                                                        @if (exportInvoice.iprotoExporter.addressLine1 === '' && exporterAddress === '') {
                                                        <span class="text-gray-500">
                                                            Select Exporter Display Details
                                                        </span>
                                                        }
                                                        @else {
                                                            @if (exportInvoice.iprotoExporter.addressLine1 !== '') {
                                                                {{exportInvoice.iprotoExporter.addressLine1}} {{exportInvoice.iprotoExporter.addressLine2}} {{exportInvoice.iprotoExporter.addressLine3}}, {{exportInvoice.iprotoExporter.city}}, {{exportInvoice.iprotoExporter.state}}, {{exportInvoice.iprotoExporter.country}}, {{exportInvoice.iprotoExporter.pincode}},{{exportInvoice.iprotoExporter.emailId}}, {{exportInvoice.iprotoExporter.gstnUinNumber}}
                                                            }
                                                            @else {
                                                                {{exporterAddress}}
                                                            }
                                                        }
                                                    
                                                    </p>
                                                </div>
                                                <div class="flex flex-col">
                                                    <p class="text-xs whitespace-pre-line break-all">
                                                        @if (exportInvoice.iprotoExportConsignee.addressLine1 === '' && consigneeAddress === '') {
                                                        <span class="text-gray-500">
                                                            Select Consignee Display Details
                                                        </span>
                                                        }
                                                        @else {
                                                        @if (exportInvoice.iprotoExportConsignee.addressLine1 !== '') {
                                                        {{exportInvoice.iprotoExportConsignee.addressLine1}} {{exportInvoice.iprotoExportConsignee.addressLine2}}
                                                        {{exportInvoice.iprotoExportConsignee.addressLine3}}, {{exportInvoice.iprotoExportConsignee.city}},
                                                        {{exportInvoice.iprotoExportConsignee.state}}, {{exportInvoice.iprotoExportConsignee.country}},
                                                        {{exportInvoice.iprotoExportConsignee.pincode}}, {{exportInvoice.iprotoExportConsignee.emailId}}, {{exportInvoice.iprotoExportConsignee.gstnUinNumber}}
                                                        }
                                                        @else {
                                                        {{consigneeAddress}}
                                                        }
                                                        }
                                                    
                                                    </p>
                                                </div>
                                                <div class="flex flex-col">
                                                    <p class="text-xs whitespace-pre-line break-all">
                                                        @if (exportInvoice.iprotoParty.addressLine1 === '' && partyAddress === '') {
                                                        <span class="text-gray-500">
                                                            Select Party Display Details
                                                        </span>
                                                        }
                                                        @else {
                                                        @if (exportInvoice.iprotoParty.addressLine1 !== '') {
                                                        {{exportInvoice.iprotoParty.addressLine1}} {{exportInvoice.iprotoParty.addressLine2}}
                                                        {{exportInvoice.iprotoParty.addressLine3}}, {{exportInvoice.iprotoParty.city}},
                                                        {{exportInvoice.iprotoParty.state}}, {{exportInvoice.iprotoParty.country}},
                                                        {{exportInvoice.iprotoParty.pincode}}, {{exportInvoice.iprotoParty.emailId}}, {{exportInvoice.iprotoParty.gstnUinNumber}}
                                                        }
                                                        @else {
                                                        {{partyAddress}}
                                                        }
                                                        }
                                                    
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="block ml-auto mx-4">
                                            <label class="text-xs text-label font-normal">
                                                Amount
                                            </label>
                                        </div>
                                        @for (item of exportInvoice.lstprotoExportInvoiceDetail; track item; let i = $index)
                                        {
                                        <div class="grid grid-cols-12 gap-x-3 mx-4 py-2">
                                            <div class="flex self-center">
                                               {{i+1}}
                                            </div>
                                            <div class="block col-span-3">
                                                <app-packageno-description label="Package no or Description"  [(ngModel)]="item.packageNo" name="packageNo" [displayText]="item.packageNo" [labelAnimation]="true" (onSelect)="selectPackage($event, item)"/>
                                            </div>
                                            <div class="block col-span-2">
                                                <app-number-control label="Quantity" [(ngModel)]="item.quantity" name="quantity{{i}}" [labelAnimation]="true"
                                                [disabled]="true" />
                                            </div>
                                            <div class="block col-span-2">
                                               <app-input-control label="Unit" [labelAnimation]="true" [(ngModel)]="item.unitTypeDescription" name="unitTypeDescription" [disabled]="true"/>
                                            </div>
                                            <div class="block col-span-2">
                                                <app-number-control label="Rate" [(ngModel)]="item.rate" name="rate{{i}}" [labelAnimation]="true"
                                                    (ngModelChange)="onCalculate()" />
                                            </div>
                                            <div class="flex items-center gap-x-1 col-span-2 form-group text-right justify-end">
                                                <div class="text-value text-xs text-right font-medium leading-5">
                                                    {{item.amount}} <span class="block">{{item.invoiceRate}}</span>
                                                </div>
                                                @if (i !== 0) {
                                                <button class="rounded-full p-2 flex items-center justify-center bg-[#FF0012]"
                                                    (click)="deleteItemAlert(item, i)" type="button">
                                                    <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path
                                                            d="M12.9199 6.95996V13.9629C12.9199 14.2098 12.7198 14.4099 12.4729 14.4099H2.93699C2.69012 14.4099 2.48999 14.2098 2.48999 13.9629V6.95996"
                                                            stroke="white" stroke-width="1.11749" stroke-linecap="round" stroke-linejoin="round" />
                                                        <path d="M6.21484 11.4299V6.95996" stroke="white" stroke-width="1.11749" stroke-linecap="round"
                                                            stroke-linejoin="round" />
                                                        <path d="M9.19482 11.4299V6.95996" stroke="white" stroke-width="1.11749" stroke-linecap="round"
                                                            stroke-linejoin="round" />
                                                        <path
                                                            d="M14.4099 3.97997H10.6849M10.6849 3.97997V1.447C10.6849 1.20013 10.4848 1 10.2379 1H5.17196C4.92509 1 4.72496 1.20013 4.72496 1.447V3.97997M10.6849 3.97997H4.72496M1 3.97997H4.72496"
                                                            stroke="white" stroke-width="1.11749" stroke-linecap="round" stroke-linejoin="round" />
                                                    </svg>
                                        
                                        
                                                </button>
                                                }
                                            </div>
                                        </div>
                                        }
                                        
                                        <div class="bg-[#F8F8F8] p-2 flex items-center mx-4">
                                            <div class="flex items-center gap-x-2">
                                                <button
                                                    class="w-9 h-9 font-normal flex items-center justify-center border-2 border-grey-dc text-center rounded-md text-2xl bg-white text-[#323232] transition-all duration-500 ease-in-out hover:border-primary-dc hover:text-primary-dc"
                                                    (click)="createItem()" type="button">
                                                    +
                                                </button>
                                                <h4 class="text-primary-dc">
                                                    Add another item
                                                </h4>
                                            </div>
                                            <div class="mx-auto form-group text-right">
                                                <label class="text-xs text-label">
                                                    Overall Total
                                                </label>
                                                <div class="text-value text-sm font-semibold">
                                                    {{exportInvoice.overAllTotal}}
                                                </div>
                                            </div>
                                        
                                            <div class="ml-auto form-group">
                                                <label class="text-label text-xs">
                                                    Taxable Value
                                                </label>
                                                <div class="text-value text-sm font-semibold text-right">
                                                    {{exportInvoice.taxableValue}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-5 gap-x-2 py-4 mx-4">

                                            <div class="flex flex-col items-center col-span-3">
                                                <div class="grid grid-cols-4 gap-x-3">
                                                    <div class="block col-span-2">
                                                        <app-input-control [labelAnimation]="true" label="No & Kind of packages" [(ngModel)]="exportInvoice.noAndKindOfPakage" name="noAndKindOfPakage"/>
                                                    </div>
                                                    <div class="block">
                                                        <app-input-control [labelAnimation]="true" label="Net Wt"
                                                            [(ngModel)]="exportInvoice.netWeight" name="netWeight" />
                                                    </div>
                                                    <div class="block">
                                                        <app-input-control [labelAnimation]="true" label="Gross Wt" [(ngModel)]="exportInvoice.grossWeight" name="grossWeight" />
                                                    </div>
                                                </div>
                                               <div class="mt-auto mr-auto flex items-center gap-x-3">
                                                <span class="text-label text-xs">
                                                    Total in words USD :
                                                </span>
                                                <span class="text-sm font-medium">
                                                    {{invoiceTotalText}}
                                                </span>
                                               </div>
                                            </div>
                                            <div class="flex flex-col gap-y-2 col-span-2 justify-end">
                                                <div class="grid grid-cols-2 items-center gap-x-3 px-2">
                                                    <div class="flex items-center gap-x-2">
                                                        <label class="text-label text-xs">
                                                            CGST
                                                        </label>
                                                        <div class="input-group relative w-36">
                                                            <input type="text" class="pl-2 pr-11 w-full outline-none border border-grey-dc rounded-md h-9 " [(ngModel)]="exportInvoice.cgstTaxPercentage"
                                                                name="cgstTaxPercentage" (ngModelChange)="onCalculate()"/>
                                                            <span
                                                                class="absolute top-0 right-0 text-center w-9 h-9 bg-[#F1F1F1] rounded-md text-xl text-[#323232] leading-9">
                                                                %
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <strong class="text-[#323232] text-sm text-right">
                                                        {{exportInvoice.cgstValue}}
                                                    </strong>
                                                </div>
                                                <div class="grid grid-cols-2 items-center gap-x-3 px-2">
                                                    <div class="flex items-center gap-x-2">
                                                        <label class="text-label text-xs">
                                                            SGST
                                                        </label>
                                                        <div class="input-group relative w-36">
                                                            <input type="text" class="pl-2 pr-11 w-full outline-none border border-grey-dc rounded-md h-9 " [(ngModel)]="exportInvoice.sgstTaxPercentage"
                                                                name="cgstTaxPercentage" (ngModelChange)="onCalculate()"/>
                                                            <span
                                                                class="absolute top-0 right-0 text-center w-9 h-9 bg-[#F1F1F1] rounded-md text-xl text-[#323232] leading-9">
                                                                %
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <strong class="text-[#323232] text-sm text-right">
                                                        {{exportInvoice.sgstValue}}
                                                    </strong>
                                                </div>
                                                <div class="grid grid-cols-2 items-center gap-x-3 px-2">
                                                    <div class="flex items-center gap-x-2">
                                                        <label class="text-label text-xs text-right">
                                                            Total Tax Amount
                                                        </label>
                                                    </div>
                                                    <strong class="text-[#323232] text-sm text-right">
                                                        {{exportInvoice.totalTaxAmount}}
                                                    </strong>
                                                </div>
                                                <div class="grid grid-cols-2 items-center gap-x-3 px-2">
                                                    <div class="flex items-center gap-x-2">
                                                        <label class="text-label text-xs text-right">
                                                            Round off
                                                        </label>
                                                    </div>
                                                    <strong class="text-[#323232] text-sm text-right">
                                                        {{exportInvoice.roundOff}}
                                                    </strong>
                                                </div>
                                                <div class="grid grid-cols-2 py-2 px-2 items-center gap-x-3 bg-[#F8F8F8]">
                                                    <div class="flex items-center gap-x-2">
                                                        <label class="text-label text-xs">
                                                            Invoice Total
                                                        </label>
                                                    </div>
                                                    <strong class="text-[#323232] text-sm text-right">
                                                        {{exportInvoice.invoiceTotal}}
                                                    </strong>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-6 gap-x-2 py-4 mx-4 border-b border-b-grey-dc">
                                            <div class="flex flex-col gap-y-1 col-span-4">
                                                <h6 class="text-xs text-[#323232]">
                                                    Bank Account Details
                                                </h6>
                                                <h5 class="text-sm text-black font-semibold">
                                                    JJ Traders
                                                </h5>
                                                <span class="text-xs text-[#323232]">
                                                    Bank : Indian Bank | A/c No : 54874894849
                                                </span>
                                                <span class="text-xs text-[#323232]">
                                                    Branch Address : 48, Lorem Ipsum Dolor Sit Amet, Lorem
                                                </span>
                                                <span class="text-xs text-[#323232]">
                                                    Branch Code: 6023
                                                </span>
                                                <span class="text-xs text-[#323232]">
                                                    SWIFT CODE : IDIBINBBSLM
                                                </span>
                                                <span class="text-xs text-[#323232]">
                                                    AD Code : 584987
                                                </span>
                                            </div>
                                            <div class="flex flex-col gap-y-2 col-span-2">
                                                <div class="block">
                                                    <app-attachment-control label="Attachment Signature"  [(ngModel)]="exportInvoice.signatureCopy" name="invoicePhotoCopy" [file]="exportInvoice.signatureCopy" (selectedFile)="selectFile($event)"/>
                                                </div>
                                                <p class="text-sm text-center font-semibold">
                                                    JJ Traders
                                                </p>
                                            </div>
                                        </div>
                                        <div class="flex flex-col gap-y-2 py-3 mx-4">
                                            <h5 class="text-sm text-[#323232] font-semibold">
                                                Declaration
                                            </h5>
                                            <p class="text-sm text-[#323232]">
                                                We declare that this invoice shows the actual price of the goods described and that all particulars are true and
                                                correct.
                                            </p>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center py-3 px-4 border-t border-t-grey-dc">
                            <div class="ml-auto flex items-center  gap-x-4">
                                <button
                                    class="dc-button text-[#323232] border border-grey-dc max-w-max rounded-md hover:bg-[#747474] hover:text-white" [routerLink]="['/home/export_invoice']">
                                    Cancel
                                </button>
                                <button
                                    class="dc-button max-w-max text-white bg-[#B188FF] border border-[#722BE2] rounded-md hover:bg-[#722BE2]"
                                  (click)="save()" >
                                    {{exportInvoice.exportInvoiceId === 0 ? 'Save' : 'Update'}}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>